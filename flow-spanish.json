{
  "description": "ofa-chatbotv2-Spanish",
  "states": [
    {
      "name": "Trigger",
      "type": "trigger",
      "transitions": [
        {
          "next": "splitFoodorComida",
          "event": "incomingMessage"
        },
        {
          "event": "incomingCall"
        },
        {
          "next": "sendSpanishOutgoing",
          "event": "incomingRequest"
        }
      ],
      "properties": {
        "offset": {
          "x": 1110,
          "y": -950
        }
      }
    },
    {
      "name": "sendNoThanks",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 300,
          "y": 570
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "No hay problema. ¡No me pondré en contacto con usted de nuevo! Puede enviar un mensaje de texto con la palabra \"COMIDA\" en cualquier momento si desea obtener información."
      }
    },
    {
      "name": "askSpanishLanguage",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitAllLanguages",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1030,
          "y": 220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿En qué idioma preferiría recibir estos mensajes?\n\n0. Inglés \n1. Español (Latinoamericano)\n2. Chino Simplificado\n3. Criollo Haitiano\n4. Vietnamita\n5. Criollo Caboverdiano\n6. Portugés (Brasilieño)\n7. Ruso\n8. Arábico\n9. Francés\n10. Somalí",
        "timeout": "3600"
      }
    },
    {
      "name": "sendIncomingSpanishWelcome",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitSpanish",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -380,
          "y": -370
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Hola, soy el ChatBot de la Oficina de Acceso a Alimentos de Boston. ¿Le gustaría continuar en español? Por favor responda SI o NO.",
        "timeout": "3600"
      }
    },
    {
      "name": "languageSpanish",
      "type": "set-variables",
      "transitions": [
        {
          "next": "askLearnAbout",
          "event": "next"
        }
      ],
      "properties": {
        "variables": [
          {
            "value": "Spanish",
            "key": "language"
          }
        ],
        "offset": {
          "x": -490,
          "y": 250
        }
      }
    },
    {
      "name": "errorSpanish",
      "type": "send-message",
      "transitions": [
        {
          "next": "sendIncomingSpanishWelcome",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -880,
          "y": -90
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "askLearnAbout",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "getLearn",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -350,
          "y": 1220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿Sobre qué tipo de recursos busca obtener más información?  \n\n1. Programas de beneficios \n2. Donde recoger comida \n3. Domicilios de comida o víveres de bajo costo  \n\nSolo puedo responder a una opción a la vez, pero podremos volver a estas opciones más adelante. Responda solo una opción 1, 2 o 3.",
        "timeout": "3600"
      }
    },
    {
      "name": "splitLearnAbout",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorLearnAbout",
          "event": "noMatch"
        },
        {
          "next": "askBenefit",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-1",
              "arguments": [
                "{{widgets.askLearnAbout.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "1, Programas de Beneficios, Programas, Beneficios , Benefit"
            }
          ]
        },
        {
          "next": "askPickup",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-2",
              "arguments": [
                "{{widgets.askLearnAbout.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "2, Donde Recoger Comida, Recoger, Recoger Comida"
            }
          ]
        },
        {
          "next": "sendDelivery",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-3",
              "arguments": [
                "{{widgets.askLearnAbout.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "3, Domicilios de Comida o Víveres de Bajo Costo, Domicilios"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askLearnAbout.inbound.Body}}",
        "offset": {
          "x": -660,
          "y": 1480
        }
      }
    },
    {
      "name": "splitSpanish",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorSpanish",
          "event": "noMatch"
        },
        {
          "next": "languageSpanish",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-yes",
              "arguments": [
                "{{widgets.sendIncomingSpanishWelcome.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "SI, Y"
            }
          ]
        },
        {
          "next": "askSpanishLanguage",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-no",
              "arguments": [
                "{{widgets.sendIncomingSpanishWelcome.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "No, N"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sendIncomingSpanishWelcome.inbound.Body}}",
        "offset": {
          "x": -380,
          "y": -100
        }
      }
    },
    {
      "name": "errorLearnAbout",
      "type": "send-message",
      "transitions": [
        {
          "next": "askLearnAbout",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1040,
          "y": 1220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "askBenefit",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "getBenefit",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -710,
          "y": 1720
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿Sobre cuál programa le gustaría obtener información?\n\nA. Programa de asistencia nutricional suplementaria (SNAP)\nB. Programa de nutrición para mujeres, bebés y niños (WIC)\nC. Programa de incentivos saludables (HIP)\nD. Tiendas Double Up Food Bucks\n\nSolo puedo responder a una opción a la vez, pero podremos volver a estas opciones más adelante. Responda solo una opción A, B, C, D, ATRAS o PARAR.",
        "timeout": "3600"
      }
    },
    {
      "name": "splitBenefit",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorBenefit",
          "event": "noMatch"
        },
        {
          "next": "sendSNAP",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-a",
              "arguments": [
                "{{widgets.askBenefit.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "A"
            }
          ]
        },
        {
          "next": "sendWIC",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-b",
              "arguments": [
                "{{widgets.askBenefit.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "B"
            }
          ]
        },
        {
          "next": "sendHIP",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-c",
              "arguments": [
                "{{widgets.askBenefit.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "C"
            }
          ]
        },
        {
          "next": "sendDoubleUp",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-d",
              "arguments": [
                "{{widgets.askBenefit.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "D"
            }
          ]
        },
        {
          "next": "askLearnAbout",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-back",
              "arguments": [
                "{{widgets.askBenefit.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "ATRAS"
            }
          ]
        },
        {
          "next": "sendNoThanks",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-stop",
              "arguments": [
                "{{widgets.askBenefit.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "PARAR"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askBenefit.inbound.Body}}",
        "offset": {
          "x": -1180,
          "y": 1970
        }
      }
    },
    {
      "name": "askPickup",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "getPickup",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -320,
          "y": 1760
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿Está buscando comprar comida asequible o gratuita? Puede recoger comida gratuita o asequible en varios lugares de la ciudad.\n \nA. Despensas de alimentos (GRATIS)\nB. Mercados de agricultores (SNAP + HIP)\nC. Sitios de comidas para jóvenes (GRATIS)\nD. Alimentos justos (bolsas de víveres de $2)\nE. Mercado de agricultores móviles ( SNAP + HIP)\nF. Tiendas de Boston Double Up Food Bucks (SNAP)\n\nSolo puedo responder a una opción a la vez, pero podremos volver a estas opciones más adelante. Responda solo una opción A, B, C, D, E, F, ATRAS, o PARAR.",
        "timeout": "3600"
      }
    },
    {
      "name": "splitPickup",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorPickup",
          "event": "noMatch"
        },
        {
          "next": "sendFoodPantry",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-a",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "A"
            }
          ]
        },
        {
          "next": "sendFarmersMarket",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-b",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "B"
            }
          ]
        },
        {
          "next": "sendYouthMeals",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-c",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "C"
            }
          ]
        },
        {
          "next": "sendFairFoods",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-d",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "D"
            }
          ]
        },
        {
          "next": "sendFreshTruck",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-e",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "E"
            }
          ]
        },
        {
          "next": "sendDoubleUp",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-f",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "F"
            }
          ]
        },
        {
          "next": "askLearnAbout",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-back",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "ATRAS"
            }
          ]
        },
        {
          "next": "sendNoThanks",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-stop",
              "arguments": [
                "{{widgets.askPickup.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "PARAR"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askPickup.inbound.Body}}",
        "offset": {
          "x": -200,
          "y": 1970
        }
      }
    },
    {
      "name": "sendDelivery",
      "type": "send-message",
      "transitions": [
        {
          "next": "askLearnMore",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 780,
          "y": 1770
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Algunas de las opciones de entregas de alimentos asequibles en Boston son:\n\nFRIDAY FOOD MARKET: \nAhorre dinero en productos y ayude a reducir el desperdicio de alimentos comprando el exceso de productos de los distribuidores de alimentos de Boston. Reciba su producto al día siguiente mediante entrega. Por solo $2. Para realizar pedidos en línea, visite https://fridayfoodmarket.com/ \n\nDAILY TABLE: Productos con descuento y entregas gratuitas a lugares ubicados a 2 millas de sus tiendas. Use SNAP y Boston Double Up Food Bucks en sus ubicaciones. Para comprar en línea, visite https://dailytable.org/shop/ ."
      }
    },
    {
      "name": "askLearnMore",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitLearnMore",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 1040,
          "y": 3030
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿Puedo ayudarle con algo más? ¿Le gustaría obtener más información sobre otros recursos alimenticios? Responda SI o NO.",
        "timeout": "3600"
      }
    },
    {
      "name": "splitLearnMore",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorLearnMore",
          "event": "noMatch"
        },
        {
          "next": "askLearnAbout",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-yes",
              "arguments": [
                "{{widgets.askLearnMore.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "SI, Y"
            }
          ]
        },
        {
          "next": "sendNoThanks",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-no",
              "arguments": [
                "{{widgets.askLearnMore.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "No, N"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askLearnMore.inbound.Body}}",
        "offset": {
          "x": 820,
          "y": 1210
        }
      }
    },
    {
      "name": "sendHIP",
      "type": "send-message",
      "transitions": [
        {
          "next": "askSNAP",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1010,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Todos los beneficiarios de SNAP pueden participar en HIP, sin necesidad de registrarse. Gaste sus dólares de SNAP en frutas y verduras frescas en mercados de agricultores participantes. ¡El valor de su compra será devuelto instantáneamente a su tarjeta EBT!\n\nEl beneficio dependerá del tamaño de su hogar. Un hogar de:\n1-2 personas puede recibir hasta $40 por mes. \n3-5 personas puede recibir hasta $60 por mes. \nPara más de 6 personas, puede recibir hasta $80 por mes. \n\nPara obtener más información, visite https://www.boston.gov/healthy-incentives/."
      }
    },
    {
      "name": "sendWIC",
      "type": "send-message",
      "transitions": [
        {
          "next": "askBenefit",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1360,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "WIC es un programa de nutrición que brinda alimentos saludables, educación nutricional, apoyo para la lactancia materna, atención médica y otros servicios gratuitos para las familias que califican. Puede presentar una solicitud en línea en https://www.mass.gov/forms/apply-for-wic-online/ o llamar al 1-800-942-1007 y al 617-721-6601 de lunes a viernes de 9am a 5pm.\n\nSi desea obtener más información sobre el programa, visite https://www.mass.gov/wic-information-for-participants/."
      }
    },
    {
      "name": "sendDoubleUp",
      "type": "send-message",
      "transitions": [
        {
          "next": "askSNAP",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -680,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Las tiendas Double Up Food Bucks ofrecen 50% de descuento en frutas y verduras a cualquier comprador de SNAP. Puede ahorrar hasta $ 10 por día. Puede encontrar una tienda cerca de usted en https://www.boston.gov/double-up/."
      }
    },
    {
      "name": "sendFoodPantry",
      "type": "send-message",
      "transitions": [
        {
          "next": "askPickup",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -350,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Visite https://www.gbfb.org/need-food/ y busque por código postal. Llame a la despensa antes de ir para verificar el horario. "
      }
    },
    {
      "name": "sendFarmersMarket",
      "type": "send-message",
      "transitions": [
        {
          "next": "askHIP",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 0,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Los mercados de agricultores son asequibles a través de programas de beneficios como SNAP y HIP. Visite https://www.boston.gov/farmers-markets/ para encontrar un mercado cerca de usted."
      }
    },
    {
      "name": "sendYouthMeals",
      "type": "send-message",
      "transitions": [
        {
          "next": "askPickup",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 340,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Estos sitios ofrecen desayuno y almuerzo a niños y jóvenes menores de 18 años. No se requiere identificación para recoger una comida. Para buscar ubicaciones, visite https://www.boston.gov/boston-eats/. Llame al sitio antes de ir para verificar el horario"
      }
    },
    {
      "name": "askSNAP",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitSNAP2",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -910,
          "y": 2530
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿Le gustaría obtener información sobre cómo inscribirse en SNAP? Responda SÍ o NO. ",
        "timeout": "3600"
      }
    },
    {
      "name": "splitSNAP2",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorSNAP",
          "event": "noMatch"
        },
        {
          "next": "sendSNAPEnroll",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-yes",
              "arguments": [
                "{{widgets.askSNAP.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "SI, Y"
            }
          ]
        },
        {
          "next": "sendSNAPNoEnroll",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-no",
              "arguments": [
                "{{widgets.askSNAP.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "No, N"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askSNAP.inbound.Body}}",
        "offset": {
          "x": -1000,
          "y": 2760
        }
      }
    },
    {
      "name": "askHIP",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitHIP",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 10,
          "y": 2540
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "¿Le gustaría aprender sobre el Programa de Incentivos Saludables (HIP)? Responda SÍ, ATRAS o NO. ",
        "timeout": "3600"
      }
    },
    {
      "name": "splitHIP",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorHIP",
          "event": "noMatch"
        },
        {
          "next": "sendHIP",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-yes",
              "arguments": [
                "{{widgets.askHIP.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "SI, Y"
            }
          ]
        },
        {
          "next": "askPickup",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-back",
              "arguments": [
                "{{widgets.askHIP.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "ATRAS"
            }
          ]
        },
        {
          "next": "sendNoThanks",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-stop",
              "arguments": [
                "{{widgets.askHIP.inbound.Body}}"
              ],
              "type": "equal_to",
              "value": "PARAR"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askHIP.inbound.Body}}",
        "offset": {
          "x": -100,
          "y": 2750
        }
      }
    },
    {
      "name": "sendFairFoods",
      "type": "send-message",
      "transitions": [
        {
          "next": "askPickup",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 690,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Los sitios de Fair Foods ofrecen bolsas de productos frescos por solo $ 2. Para buscar ubicaciones cerca de usted, visite https://www.bit.ly/fairfoods20/"
      }
    },
    {
      "name": "sendFreshTruck",
      "type": "send-message",
      "transitions": [
        {
          "next": "askHIP",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 1040,
          "y": 2220
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Fresh Truck es un mercado agrícola móvil. SNAP y HIP están disponibles en sus ubicaciones. Para ver su horario, visite https://www.aboutfresh.org/fresh-truck/#schedule/."
      }
    },
    {
      "name": "errorPickup",
      "type": "send-message",
      "transitions": [
        {
          "next": "askPickup",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 960,
          "y": 1970
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "errorBenefit",
      "type": "send-message",
      "transitions": [
        {
          "next": "askBenefit",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1550,
          "y": 1970
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "errorSNAP",
      "type": "send-message",
      "transitions": [
        {
          "next": "askSNAP",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1870,
          "y": 2770
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "errorHIP",
      "type": "send-message",
      "transitions": [
        {
          "next": "askHIP",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -410,
          "y": 2540
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "sendSpanishOutgoing",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitSpanishOutgoing",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 3910,
          "y": -360
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "Hola {firstname}, soy el ChatBot de la Oficina de Acceso a Alimentos de Boston. Usted completó una solicitud para el Fondo de Ayuda para el Alquiler y le dio permiso a la Ciudad de Boston para comunicarse con usted por mensaje de texto. ¿Le gustaría aprender acerca de los recursos alimenticios disponibles para usted? Responda SI o NO.",
        "timeout": "3600"
      }
    },
    {
      "name": "splitFoodorComida",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-food",
              "arguments": [
                "{{trigger.message.Body}}"
              ],
              "type": "matches_any_of",
              "value": "FOOD"
            }
          ]
        },
        {
          "next": "sendIncomingSpanishWelcome",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-comida",
              "arguments": [
                "{{trigger.message.Body}}"
              ],
              "type": "matches_any_of",
              "value": "COMIDA"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{trigger.message.Body}}",
        "offset": {
          "x": 120,
          "y": -380
        }
      }
    },
    {
      "name": "splitAllLanguages",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "askLearnAbout",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-eng",
              "arguments": [
                "{{widgets.askSpanishLanguage.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "1, ENG, Spanish"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.askSpanishLanguage.inbound.Body}}",
        "offset": {
          "x": 1040,
          "y": 530
        }
      }
    },
    {
      "name": "splitSpanishOutgoing",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "SI, Y",
              "arguments": [
                "{{widgets.sendIncomingSpanishWelcome.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "SI, Y"
            }
          ]
        },
        {
          "event": "match",
          "conditions": [
            {
              "friendly_name": "NO",
              "arguments": [
                "{{widgets.sendIncomingSpanishWelcome.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "NO, N"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sendIncomingSpanishWelcome.inbound.Body}}",
        "offset": {
          "x": 3920,
          "y": -60
        }
      }
    },
    {
      "name": "sendSNAP",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "splitSNAP1",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1720,
          "y": 2230
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "body": "SNAP proporciona beneficios nutricionales para complementar los presupuestos alimentarios de las familias para que puedan comprar alimentos saludables.\n\n¿Le gustaría obtener información sobre cómo inscribirse en SNAP? Responda SÍ o NO. ",
        "timeout": "3600"
      }
    },
    {
      "name": "sendSNAPEnroll",
      "type": "send-message",
      "transitions": [
        {
          "next": "askLearnMore",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -990,
          "y": 3010
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Puede enviar un mensaje de texto con la palabra \"FOOD\" al 74544 para verificar si es elegible o llamar a Project Bread al 1-800-645-8333 para recibir ayuda en 150 idiomas.\n\nPara aplicar en línea visite https://www.mass.gov/snap-benefits-formerly-food-stamps/ ."
      }
    },
    {
      "name": "sendSNAPNoEnroll",
      "type": "send-message",
      "transitions": [
        {
          "next": "askLearnMore",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -560,
          "y": 3010
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "No hay problema. Si tiene alguna otra pregunta sobre el programa, visite https://www.mass.gov/snap-benefits-formerly-food-stamps/ o llame a Project Bread al 1-800-645-8333. Pueden ayudarlo a responder sus preguntas en 150 idiomas."
      }
    },
    {
      "name": "splitSNAP1",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "errorSNAP",
          "event": "noMatch"
        },
        {
          "next": "sendSNAPEnroll",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-yes",
              "arguments": [
                "{{widgets.sendSNAP.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "SI, Y"
            }
          ]
        },
        {
          "next": "sendSNAPNoEnroll",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "if-no",
              "arguments": [
                "{{widgets.sendSNAP.inbound.Body}}"
              ],
              "type": "matches_any_of",
              "value": "No, N"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.sendSNAP.inbound.Body}}",
        "offset": {
          "x": -1540,
          "y": 2760
        }
      }
    },
    {
      "name": "errorLearnMore",
      "type": "send-message",
      "transitions": [
        {
          "next": "splitLearnMore",
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 730,
          "y": 1430
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Lo sentimos, esa opción no es compatible actualmente. Inténtelo de nuevo."
      }
    },
    {
      "name": "getBenefit",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "splitBenefit",
          "event": "success"
        },
        {
          "next": "splitBenefit",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1500,
          "y": 1540
        },
        "method": "POST",
        "content_type": "application/x-www-form-urlencoded;charset=utf-8",
        "body": "1, Programas de Beneficios, Programas, Beneficios ",
        "parameters": [
          {
            "value": "{{widgets.askBenefit.inbound.Body}}",
            "key": "benefitchoice"
          },
          {
            "value": "{{widgets.askBenefit.inbound.From}}",
            "key": "PhoneNumber"
          }
        ],
        "url": "https://mantis-cuscus-7403.twil.io/write-ofa"
      }
    },
    {
      "name": "getPickup",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "splitPickup",
          "event": "success"
        },
        {
          "next": "splitPickup",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": 170,
          "y": 1770
        },
        "method": "POST",
        "content_type": "application/x-www-form-urlencoded;charset=utf-8",
        "body": "2, Donde Recoger Comida, Recoger, Recoger Comida",
        "parameters": [
          {
            "value": "{{widgets.askPickup.inbound.Body}}",
            "key": "pickupchoice"
          },
          {
            "value": "{{widgets.askPickup.inbound.From}}",
            "key": "PhoneNumber"
          }
        ],
        "url": "https://mantis-cuscus-7403.twil.io/write-ofa"
      }
    },
    {
      "name": "getLearn",
      "type": "make-http-request",
      "transitions": [
        {
          "next": "splitLearnAbout",
          "event": "success"
        },
        {
          "next": "splitLearnAbout",
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -160,
          "y": 1420
        },
        "method": "POST",
        "content_type": "application/x-www-form-urlencoded;charset=utf-8",
        "body": "3, Domicilios de Comida o Víveres de Bajo Costo, Domicilios",
        "parameters": [
          {
            "value": "{{widgets.askLearnAbout.inbound.Body}}",
            "key": "learnchoice"
          },
          {
            "value": "{{widgets.askLearnAbout.inbound.From}}",
            "key": "PhoneNumber"
          }
        ],
        "url": "https://mantis-cuscus-7403.twil.io/write-ofa"
      }
    }
  ],
  "initial_state": "Trigger",
  "flags": {
    "allow_concurrent_calls": true
  }
}
